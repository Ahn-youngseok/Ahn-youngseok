{"nbformat":4,"nbformat_minor":0,"metadata":{"accelerator":"TPU","colab":{"name":"덧셈1","provenance":[{"file_id":"1kABhN6YEgJwUtUrgI4zrHDrVO4viS9b_","timestamp":1635619316838},{"file_id":"1B_cMn8Zlr02KVwODq1nJv5ABgIzN1Axu","timestamp":1635398218742}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"d3758a8880904e009c0885af8bb9f4c6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_028e0a32e66d438bbc68d7540a8dd25d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_66b0d59750d2453899f45e16d3c0360f","IPY_MODEL_606c8bd3243e48b8aa17c36f4f573204","IPY_MODEL_c5f667969e0e4f71ab50d69c1ded703f"]}},"028e0a32e66d438bbc68d7540a8dd25d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"66b0d59750d2453899f45e16d3c0360f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_34d7fea4bd1843d2a93fc48070ab3e15","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bfaab73902704df69dfcf9820144dd7b"}},"606c8bd3243e48b8aa17c36f4f573204":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c2b9a634856648e4bf438468a12b5605","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":995526,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":995526,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3a1150ec69974628bfbc930af13ecd2f"}},"c5f667969e0e4f71ab50d69c1ded703f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cfade22910764718b7f8b6b5d0e22738","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 972k/972k [00:00&lt;00:00, 785kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0dbf6148cf364a25ba1c585c241d808f"}},"34d7fea4bd1843d2a93fc48070ab3e15":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bfaab73902704df69dfcf9820144dd7b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c2b9a634856648e4bf438468a12b5605":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3a1150ec69974628bfbc930af13ecd2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cfade22910764718b7f8b6b5d0e22738":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0dbf6148cf364a25ba1c585c241d808f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8e26a7585ad64027907e81cb503e0c89":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_228a827f05494525b46dd57def24fdb0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2854d9ae2e5c4252a683c023c187d1a4","IPY_MODEL_501e6bf219ac4c8584b04fc81605eee0","IPY_MODEL_97bdbd235f794d4aa88e8eea9294c6e5"]}},"228a827f05494525b46dd57def24fdb0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2854d9ae2e5c4252a683c023c187d1a4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1fbec8c80be643cd8ce1d40c3dd5887d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_05ecf2db042f422992353c1bf2e304e9"}},"501e6bf219ac4c8584b04fc81605eee0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_aa62285839984188ab03daee018dc4b3","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":29,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":29,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d39b68172524d98baa13e59f131abc2"}},"97bdbd235f794d4aa88e8eea9294c6e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_bd67b616f0934fb18836ef99ceb975d6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29.0/29.0 [00:00&lt;00:00, 579B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d4e6a28eb1d84c81b6840a6ef1ebe2af"}},"1fbec8c80be643cd8ce1d40c3dd5887d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"05ecf2db042f422992353c1bf2e304e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"aa62285839984188ab03daee018dc4b3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7d39b68172524d98baa13e59f131abc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bd67b616f0934fb18836ef99ceb975d6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d4e6a28eb1d84c81b6840a6ef1ebe2af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"994f28412aa6437f89974fdeac6ec549":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_6a4f3755a6fc45d69f56c7b77aedaaa9","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_04c759d6236f4191bc894bebe5b1e9d6","IPY_MODEL_9223c44cf4434005b1667b75a3b8a7c1","IPY_MODEL_4c1bad72edd64e5d9f707edada8db5da"]}},"6a4f3755a6fc45d69f56c7b77aedaaa9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"04c759d6236f4191bc894bebe5b1e9d6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_046ec7d40c6f42b89951d0d24c88185c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8d31ef1931a44724bdc66d88b03126a4"}},"9223c44cf4434005b1667b75a3b8a7c1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_651d263c4b3f4ecc883da1ed2efcf53b","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1961828,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1961828,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3766a37e88cd47479951cd09d4dca733"}},"4c1bad72edd64e5d9f707edada8db5da":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_586187fa00384f2d9dbb57e3dcf21f50","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.87M/1.87M [00:00&lt;00:00, 9.45MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9b51adfa6cfc478fbc3741c7d02e8b09"}},"046ec7d40c6f42b89951d0d24c88185c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8d31ef1931a44724bdc66d88b03126a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"651d263c4b3f4ecc883da1ed2efcf53b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3766a37e88cd47479951cd09d4dca733":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"586187fa00384f2d9dbb57e3dcf21f50":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9b51adfa6cfc478fbc3741c7d02e8b09":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"aaa6e90ce5734e46b651168b908b39cb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d70884d234d6434fb78eb91391f00003","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_290c4ae95c7946f2a423d47faaeac1c0","IPY_MODEL_981fd286600b4ce0ab4ccad5a21fe153","IPY_MODEL_71fa8b998e764005945da293c9b92863"]}},"d70884d234d6434fb78eb91391f00003":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"290c4ae95c7946f2a423d47faaeac1c0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a4f98a4a30e245ad89f3df5d955d7c5f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1669a3400d644b77b023e4465aa6542f"}},"981fd286600b4ce0ab4ccad5a21fe153":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6c92349aeee44d7b986b31e636f29cb2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":625,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":625,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7bfe24af720d49e6bf0552f109c4f8d0"}},"71fa8b998e764005945da293c9b92863":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_54c4544bae2642e29d55b009b059c62f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 625/625 [00:00&lt;00:00, 12.0kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_93fad2fc81f94bd8a4995094ded28da9"}},"a4f98a4a30e245ad89f3df5d955d7c5f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1669a3400d644b77b023e4465aa6542f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6c92349aeee44d7b986b31e636f29cb2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7bfe24af720d49e6bf0552f109c4f8d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"54c4544bae2642e29d55b009b059c62f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"93fad2fc81f94bd8a4995094ded28da9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2d8bcab721474866bb4231ba59610e5e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fa654844664041df99473a951a2ef412","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_503d3315f2214b6ca658000ec7d02dbe","IPY_MODEL_b4fcc2dbca9d4b33b8400432d3ff553a","IPY_MODEL_18e3ab9e1fea42f4ac2a66eb046ba020"]}},"fa654844664041df99473a951a2ef412":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"503d3315f2214b6ca658000ec7d02dbe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2b4630969c954723b58b7aef6a23b472","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Downloading: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7545499fa1da4f3ca7e38badea1ca620"}},"b4fcc2dbca9d4b33b8400432d3ff553a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f6a4586b938d486fb0148c938ea56915","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1083389348,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1083389348,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6b80a8e52af44ffa8c3863441a801c92"}},"18e3ab9e1fea42f4ac2a66eb046ba020":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9654e5c8e76c49f89f68772938941efc","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.01G/1.01G [00:26&lt;00:00, 41.0MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e2941d3c04694c8693024e49f171a6cf"}},"2b4630969c954723b58b7aef6a23b472":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7545499fa1da4f3ca7e38badea1ca620":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f6a4586b938d486fb0148c938ea56915":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6b80a8e52af44ffa8c3863441a801c92":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9654e5c8e76c49f89f68772938941efc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e2941d3c04694c8693024e49f171a6cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PPsdIXTN8dU5","executionInfo":{"status":"ok","timestamp":1635617916404,"user_tz":-540,"elapsed":3535,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"8377cd26-26ff-4e14-bee1-125ecaa5f0a5"},"source":["!pip install transformers"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.7/dist-packages (4.12.2)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.8.1)\n","Requirement already satisfied: huggingface-hub>=0.0.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.0.19)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.0)\n","Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.10.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.62.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: sacremoses in /usr/local/lib/python3.7/dist-packages (from transformers) (0.0.46)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.3.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.0.17->transformers) (3.7.4.3)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (2.4.7)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.6.0)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.5.30)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.0.1)\n"]}]},{"cell_type":"code","metadata":{"id":"qKxFaxWL8h7n"},"source":["import tensorflow as tf\n","import numpy as np\n","import pandas as pd\n","import transformers\n","from transformers import BertTokenizer\n","import json\n","import numpy as np\n","import pandas as pd\n","from tqdm import tqdm\n","import os"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Bm6mZThJB5TG"},"source":["train = pd.read_csv(\"train.csv\")\n","train1= pd.read_csv(\"train1.csv\")\n","train2= pd.read_csv(\"train2.csv\")\n","train1=pd.get_dummies(train1, columns = ['v1'])\n","train2=pd.get_dummies(train2, columns = ['v2'])\n","train3=pd.concat((train,train1),axis=1)\n","train4=pd.concat((train,train2),axis=1)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WIQj17Me3BqH","executionInfo":{"status":"ok","timestamp":1635617916407,"user_tz":-540,"elapsed":11,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"efc2a429-5a90-4368-cd53-27b7d0bdf908"},"source":["index_1=train3.columns.tolist()\n","del index_1[0]\n","\n","index_2=train4.columns.tolist()\n","del index_2[0]\n","\n","print(index_2)\n"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['v2_1', 'v2_2', 'v2_3', 'v2_4', 'v2_5', 'v2_6', 'v2_7', 'v2_8', 'v2_9', 'v2_10']\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LWN59l32_Pda","executionInfo":{"status":"ok","timestamp":1635617916408,"user_tz":-540,"elapsed":9,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"247fa3e1-ae63-4324-a073-3f5e562fdc52"},"source":["print(train3['v1_10'][30])"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["1\n"]}]},{"cell_type":"code","metadata":{"id":"QKbS1HAJB-wS","colab":{"base_uri":"https://localhost:8080/","height":145,"referenced_widgets":["d3758a8880904e009c0885af8bb9f4c6","028e0a32e66d438bbc68d7540a8dd25d","66b0d59750d2453899f45e16d3c0360f","606c8bd3243e48b8aa17c36f4f573204","c5f667969e0e4f71ab50d69c1ded703f","34d7fea4bd1843d2a93fc48070ab3e15","bfaab73902704df69dfcf9820144dd7b","c2b9a634856648e4bf438468a12b5605","3a1150ec69974628bfbc930af13ecd2f","cfade22910764718b7f8b6b5d0e22738","0dbf6148cf364a25ba1c585c241d808f","8e26a7585ad64027907e81cb503e0c89","228a827f05494525b46dd57def24fdb0","2854d9ae2e5c4252a683c023c187d1a4","501e6bf219ac4c8584b04fc81605eee0","97bdbd235f794d4aa88e8eea9294c6e5","1fbec8c80be643cd8ce1d40c3dd5887d","05ecf2db042f422992353c1bf2e304e9","aa62285839984188ab03daee018dc4b3","7d39b68172524d98baa13e59f131abc2","bd67b616f0934fb18836ef99ceb975d6","d4e6a28eb1d84c81b6840a6ef1ebe2af","994f28412aa6437f89974fdeac6ec549","6a4f3755a6fc45d69f56c7b77aedaaa9","04c759d6236f4191bc894bebe5b1e9d6","9223c44cf4434005b1667b75a3b8a7c1","4c1bad72edd64e5d9f707edada8db5da","046ec7d40c6f42b89951d0d24c88185c","8d31ef1931a44724bdc66d88b03126a4","651d263c4b3f4ecc883da1ed2efcf53b","3766a37e88cd47479951cd09d4dca733","586187fa00384f2d9dbb57e3dcf21f50","9b51adfa6cfc478fbc3741c7d02e8b09","aaa6e90ce5734e46b651168b908b39cb","d70884d234d6434fb78eb91391f00003","290c4ae95c7946f2a423d47faaeac1c0","981fd286600b4ce0ab4ccad5a21fe153","71fa8b998e764005945da293c9b92863","a4f98a4a30e245ad89f3df5d955d7c5f","1669a3400d644b77b023e4465aa6542f","6c92349aeee44d7b986b31e636f29cb2","7bfe24af720d49e6bf0552f109c4f8d0","54c4544bae2642e29d55b009b059c62f","93fad2fc81f94bd8a4995094ded28da9"]},"executionInfo":{"status":"ok","timestamp":1635617918820,"user_tz":-540,"elapsed":2419,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"88092684-280f-4cbd-dff3-d86ead3cd44b"},"source":["tokenizer = BertTokenizer.from_pretrained('bert-base-multilingual-cased')"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d3758a8880904e009c0885af8bb9f4c6","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/972k [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8e26a7585ad64027907e81cb503e0c89","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"994f28412aa6437f89974fdeac6ec549","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/1.87M [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"aaa6e90ce5734e46b651168b908b39cb","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/625 [00:00<?, ?B/s]"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f5UQhMhEZYUA","executionInfo":{"status":"ok","timestamp":1635617918820,"user_tz":-540,"elapsed":9,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"53b1d420-41b6-410f-a5bf-3a1d0c9488f1"},"source":["def convert_data(data_df):\n","    global tokenizer\n","    \n","    SEQ_LEN = 20 #SEQ_LEN : 버트에 들어갈 인풋의 길이\n","    \n","    tokens, masks, segments, targets, targets1 = [], [], [], [], []\n","    \n","    for i in tqdm(range(len(data_df))):\n","        # token : 문장을 토큰화함\n","        token = tokenizer.encode(data_df[DATA_COLUMN][i], max_length=SEQ_LEN, truncation=True, padding='max_length')\n","       \n","        # 마스크는 토큰화한 문장에서 패딩이 아닌 부분은 1, 패딩인 부분은 0으로 통일\n","        num_zeros = token.count(0)\n","        mask = [1]*(SEQ_LEN-num_zeros) + [0]*num_zeros\n","        \n","        # 문장의 전후관계를 구분해주는 세그먼트는 문장이 1개밖에 없으므로 모두 0\n","        segment = [0]*SEQ_LEN\n","\n","        # 버트 인풋으로 들어가는 token, mask, segment를 tokens, segments에 각각 저장\n","        tokens.append(token)\n","        masks.append(mask)\n","        segments.append(segment)\n","        \n","        # 정답(긍정 : 1 부정 0)을 targets 변수에 저장해 줌\n","        for ii in range(1,11):\n","          targets1.append(data_df[\"v1_%i\"%ii][i])\n","        targets.append(targets1)\n","        targets1=[]\n","    # tokens, masks, segments, 정답 변수 targets를 numpy array로 지정    \n","    tokens = np.array(tokens)\n","    masks = np.array(masks)\n","    segments = np.array(segments)\n","    targets = np.array(targets)\n","\n","    return [tokens, masks, segments], targets\n","\n","\n","    \n","# 위에 정의한 convert_data 함수를 불러오는 함수를 정의\n","def load_data(pandas_dataframe):\n","    data_df = pandas_dataframe\n","    data_df[DATA_COLUMN] = data_df[DATA_COLUMN].astype(str)\n","    data_df[LABEL_COLUMN] = data_df[LABEL_COLUMN]\n","    data_x, data_y = convert_data(data_df)\n","    return data_x, data_y\n","\n","\n","SEQ_LEN = 20\n","BATCH_SIZE = 1\n","\n","DATA_COLUMN = \"문제\"\n","\n","LABEL_COLUMN = index_1\n","\n","# train 데이터를 버트 인풋에 맞게 변환\n","train_x_1, train_y_1 = load_data(train3)\n"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 88/88 [00:00<00:00, 2627.47it/s]\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qId14B4eNCsy","executionInfo":{"status":"ok","timestamp":1635617919224,"user_tz":-540,"elapsed":408,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"70dbfa35-72d3-4783-e7c5-866ddcaf19bd"},"source":["def convert_data(data_df):\n","    global tokenizer\n","    \n","    SEQ_LEN = 20 #SEQ_LEN : 버트에 들어갈 인풋의 길이\n","    \n","    tokens, masks, segments, targets, targets1 = [], [], [], [], []\n","    \n","    for i in tqdm(range(len(data_df))):\n","        # token : 문장을 토큰화함\n","        token = tokenizer.encode(data_df[DATA_COLUMN][i], max_length=SEQ_LEN, truncation=True, padding='max_length')\n","       \n","        # 마스크는 토큰화한 문장에서 패딩이 아닌 부분은 1, 패딩인 부분은 0으로 통일\n","        num_zeros = token.count(0)\n","        mask = [1]*(SEQ_LEN-num_zeros) + [0]*num_zeros\n","        \n","        # 문장의 전후관계를 구분해주는 세그먼트는 문장이 1개밖에 없으므로 모두 0\n","        segment = [0]*SEQ_LEN\n","\n","        # 버트 인풋으로 들어가는 token, mask, segment를 tokens, segments에 각각 저장\n","        tokens.append(token)\n","        masks.append(mask)\n","        segments.append(segment)\n","        \n","        # 정답(긍정 : 1 부정 0)을 targets 변수에 저장해 줌\n","        for ii in range(1,11):\n","          targets1.append(data_df[\"v2_%i\"%ii][i])\n","        targets.append(targets1)\n","        targets1=[]\n","    # tokens, masks, segments, 정답 변수 targets를 numpy array로 지정    \n","    tokens = np.array(tokens)\n","    masks = np.array(masks)\n","    segments = np.array(segments)\n","    targets = np.array(targets)\n","\n","    return [tokens, masks, segments], targets\n","\n","\n","    \n","# 위에 정의한 convert_data 함수를 불러오는 함수를 정의\n","def load_data(pandas_dataframe):\n","    data_df = pandas_dataframe\n","    data_df[DATA_COLUMN] = data_df[DATA_COLUMN].astype(str)\n","    data_df[LABEL_COLUMN] = data_df[LABEL_COLUMN]\n","    data_x, data_y = convert_data(data_df)\n","    return data_x, data_y\n","\n","\n","SEQ_LEN = 20\n","BATCH_SIZE = 1\n","\n","DATA_COLUMN = \"문제\"\n","\n","LABEL_COLUMN = index_2\n","\n","# train 데이터를 버트 인풋에 맞게 변환\n","train_x_2, train_y_2 = load_data(train4)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 88/88 [00:00<00:00, 3386.38it/s]\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"q1U0pxPEaRiS","executionInfo":{"status":"ok","timestamp":1635617922340,"user_tz":-540,"elapsed":3120,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"642b3806-b9df-416d-f8e9-67f7f52320b2"},"source":["!pip install transformers\n","from transformers import BertModel, TFBertModel # no attribute 'TFBertModel'"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.7/dist-packages (4.12.2)\n","Requirement already satisfied: sacremoses in /usr/local/lib/python3.7/dist-packages (from transformers) (0.0.46)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.8.1)\n","Requirement already satisfied: huggingface-hub>=0.0.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.0.19)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.3.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.10.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.62.3)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.0.17->transformers) (3.7.4.3)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (2.4.7)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.6.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.5.30)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.0.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":157,"referenced_widgets":["2d8bcab721474866bb4231ba59610e5e","fa654844664041df99473a951a2ef412","503d3315f2214b6ca658000ec7d02dbe","b4fcc2dbca9d4b33b8400432d3ff553a","18e3ab9e1fea42f4ac2a66eb046ba020","2b4630969c954723b58b7aef6a23b472","7545499fa1da4f3ca7e38badea1ca620","f6a4586b938d486fb0148c938ea56915","6b80a8e52af44ffa8c3863441a801c92","9654e5c8e76c49f89f68772938941efc","e2941d3c04694c8693024e49f171a6cf"]},"id":"Yburrk2eT-k0","executionInfo":{"status":"ok","timestamp":1635617961969,"user_tz":-540,"elapsed":39644,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"f34b1a16-c0b6-456a-a26b-9a7266af9be3"},"source":["model = TFBertModel.from_pretrained('bert-base-multilingual-cased')\n","\n","# 토큰 인풋, 마스크 인풋, 세그먼트 인풋 정의\n","token_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_word_ids')\n","mask_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_masks')\n","segment_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_segment')\n","\n","# 인풋이 [토큰, 마스크, 세그먼트]인 모델 정의\n","bert_outputs = model([token_inputs, mask_inputs, segment_inputs])\n","\n","# 버트 아웃풋의 텐서의 shape은 [batch_size, 문장의 길이, 768]임"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2d8bcab721474866bb4231ba59610e5e","version_minor":0,"version_major":2},"text/plain":["Downloading:   0%|          | 0.00/1.01G [00:00<?, ?B/s]"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some layers from the model checkpoint at bert-base-multilingual-cased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']\n","- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","All the layers of TFBertModel were initialized from the model checkpoint at bert-base-multilingual-cased.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.\n"]}]},{"cell_type":"code","metadata":{"id":"m3KujgtjmWQJ"},"source":["from tensorflow.keras.utils import plot_model"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VkMWXNDQmXm6","executionInfo":{"status":"ok","timestamp":1635617961971,"user_tz":-540,"elapsed":19,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"dbdb54fe-7a2c-4baf-bea7-609b5d74aedc"},"source":["print(bert_outputs)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["TFBaseModelOutputWithPoolingAndCrossAttentions(last_hidden_state=<KerasTensor: shape=(None, 20, 768) dtype=float32 (created by layer 'tf_bert_model')>, pooler_output=<KerasTensor: shape=(None, 768) dtype=float32 (created by layer 'tf_bert_model')>, past_key_values=None, hidden_states=None, attentions=None, cross_attentions=None)\n"]}]},{"cell_type":"code","metadata":{"id":"kTxFEfYparpl"},"source":["bert_outputs = bert_outputs[1]\n","sentiment_first = tf.keras.layers.Dense(1, activation='softmax', kernel_initializer=tf.keras.initializers.TruncatedNormal(stddev=0.02))(bert_outputs)\n","sentiment_model = tf.keras.Model([token_inputs, mask_inputs, segment_inputs], sentiment_first)\n","sentiment_model.compile(optimizer=\"Adam\", loss=\"categorical_crossentropy\", metrics = ['accuracy'])"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"TDOejHOIT-K1"},"source":[""]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2q4HSlp3dS5x","executionInfo":{"status":"ok","timestamp":1635617965874,"user_tz":-540,"elapsed":3920,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"e3455746-c588-482c-c646-32f6d445ce41"},"source":["# Rectified Adam 옵티마이저 사용\n","!pip install tensorflow_addons\n","import tensorflow_addons as tfa\n","opt = tfa.optimizers.RectifiedAdam(learning_rate=.0001, weight_decay=0.0025, warmup_proportion=0.05)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting tensorflow_addons\n","  Downloading tensorflow_addons-0.14.0-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)\n","\u001b[K     |████████████████████████████████| 1.1 MB 5.4 MB/s \n","\u001b[?25hRequirement already satisfied: typeguard>=2.7 in /usr/local/lib/python3.7/dist-packages (from tensorflow_addons) (2.7.1)\n","Installing collected packages: tensorflow-addons\n","Successfully installed tensorflow-addons-0.14.0\n"]}]},{"cell_type":"code","metadata":{"id":"4uZO9em6dWWP"},"source":["def create_sentiment_bert():\n","  # 버트 pretrained 모델 로드\n","  model = TFBertModel.from_pretrained('bert-base-multilingual-cased')\n","  # 토큰 인풋, 마스크 인풋, 세그먼트 인풋 정의\n","  token_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_word_ids')\n","  mask_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_masks')\n","  segment_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_segment')\n","  # 인풋이 [토큰, 마스크, 세그먼트]인 모델 정의\n","  bert_outputs = model([token_inputs, mask_inputs, segment_inputs])\n","\n","  bert_outputs = bert_outputs[1]\n","  sentiment_first = tf.keras.layers.Dense(10, activation='softmax', kernel_initializer=tf.keras.initializers.TruncatedNormal(stddev=0.02))(bert_outputs)\n","  sentiment_model = tf.keras.Model([token_inputs, mask_inputs, segment_inputs], sentiment_first)\n","\n","  sentiment_model.compile(optimizer=opt, loss=tf.keras.losses.CategoricalCrossentropy(), metrics = ['accuracy'])\n","  return sentiment_model"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DvPnimGvboQu","executionInfo":{"status":"ok","timestamp":1635618047572,"user_tz":-540,"elapsed":11921,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"447d87fc-fe2f-4a02-8111-42c550489b79"},"source":["TPU = True\n","if TPU:\n","  resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu='grpc://' + os.environ['COLAB_TPU_ADDR'])\n","  tf.config.experimental_connect_to_cluster(resolver)\n","  tf.tpu.experimental.initialize_tpu_system(resolver)\n","else:\n","  pass"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:absl:Entering into master device scope: /job:worker/replica:0/task:0/device:CPU:0\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:Clearing out eager caches\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:Clearing out eager caches\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:Initializing the TPU system: grpc://10.102.182.210:8470\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:Initializing the TPU system: grpc://10.102.182.210:8470\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:Finished initializing TPU system.\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:Finished initializing TPU system.\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"USZmNpGpdaqt","executionInfo":{"status":"ok","timestamp":1635618475806,"user_tz":-540,"elapsed":225491,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"802da801-e0d7-42ee-89fc-91fa1960f539"},"source":["strategy = tf.distribute.experimental.TPUStrategy(resolver)\n","\n","with strategy.scope():\n","    sentiment_model = create_sentiment_bert()\n","    sentiment_model.fit(train_x_1, train_y_1, epochs=10, shuffle=True, batch_size=1)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use  the non experimental symbol `tf.distribute.TPUStrategy` instead.\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:Found TPU system:\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:Found TPU system:\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Cores: 8\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Cores: 8\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Workers: 1\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Workers: 1\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)\n","Some layers from the model checkpoint at bert-base-multilingual-cased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']\n","- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","All the layers of TFBertModel were initialized from the model checkpoint at bert-base-multilingual-cased.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n"]},{"output_type":"stream","name":"stderr","text":["INFO:absl:TPU has inputs with dynamic shapes: [<tf.Tensor 'Const:0' shape=() dtype=int32>, <tf.Tensor 'IteratorGetNext:0' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:1' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:2' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:3' shape=(None, 10) dtype=uint8>]\n","INFO:absl:TPU has inputs with dynamic shapes: [<tf.Tensor 'Const:0' shape=() dtype=int32>, <tf.Tensor 'IteratorGetNext:0' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:1' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:2' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:3' shape=(None, 10) dtype=uint8>]\n"]},{"output_type":"stream","name":"stdout","text":["88/88 [==============================] - 107s 73ms/step - loss: 2.3086 - accuracy: 0.1136\n","Epoch 2/10\n","88/88 [==============================] - 6s 73ms/step - loss: 1.6351 - accuracy: 0.6364\n","Epoch 3/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.5185 - accuracy: 1.0000\n","Epoch 4/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.1507 - accuracy: 1.0000\n","Epoch 5/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0778 - accuracy: 1.0000\n","Epoch 6/10\n","88/88 [==============================] - 6s 72ms/step - loss: 0.0496 - accuracy: 1.0000\n","Epoch 7/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0359 - accuracy: 1.0000\n","Epoch 8/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0263 - accuracy: 1.0000\n","Epoch 9/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0207 - accuracy: 1.0000\n","Epoch 10/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0166 - accuracy: 1.0000\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lrEh70TgeIFc","executionInfo":{"status":"ok","timestamp":1635618696590,"user_tz":-540,"elapsed":3995,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"75ec55f7-d0cf-4473-d2cc-c444c3d7e7e7"},"source":["# Rectified Adam 옵티마이저 사용\n","!pip install tensorflow_addons\n","import tensorflow_addons as tfa\n","opt1 = tfa.optimizers.RectifiedAdam(learning_rate=.0001, weight_decay=0.0025, warmup_proportion=0.05)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: tensorflow_addons in /usr/local/lib/python3.7/dist-packages (0.14.0)\n","Requirement already satisfied: typeguard>=2.7 in /usr/local/lib/python3.7/dist-packages (from tensorflow_addons) (2.7.1)\n"]}]},{"cell_type":"code","metadata":{"id":"mXhtvYamdp_Y"},"source":["def create_sentiment_bert2():\n","  # 버트 pretrained 모델 로드\n","  model = TFBertModel.from_pretrained('bert-base-multilingual-cased')\n","  # 토큰 인풋, 마스크 인풋, 세그먼트 인풋 정의\n","  token_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_word_ids')\n","  mask_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_masks')\n","  segment_inputs = tf.keras.layers.Input((SEQ_LEN,), dtype=tf.int32, name='input_segment')\n","  # 인풋이 [토큰, 마스크, 세그먼트]인 모델 정의\n","  bert_outputs = model([token_inputs, mask_inputs, segment_inputs])\n","\n","  bert_outputs = bert_outputs[1]\n","  sentiment_first = tf.keras.layers.Dense(10, activation='softmax', kernel_initializer=tf.keras.initializers.TruncatedNormal(stddev=0.02))(bert_outputs)\n","  sentiment_model = tf.keras.Model([token_inputs, mask_inputs, segment_inputs], sentiment_first)\n","\n","  sentiment_model.compile(optimizer=opt1, loss=tf.keras.losses.CategoricalCrossentropy(), metrics = ['accuracy'])\n","  return sentiment_model"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"X6rM_XgwdeAV","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1635618929217,"user_tz":-540,"elapsed":226519,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"f6c07c49-8a09-4663-828f-400a5e0a4339"},"source":["strategy = tf.distribute.TPUStrategy(resolver)\n","\n","with strategy.scope():\n","  sentiment_model_2 = create_sentiment_bert2()\n","  sentiment_model_2.fit(train_x_2, train_y_2, epochs=10, shuffle=True, batch_size=1)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:Found TPU system:\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:Found TPU system:\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Cores: 8\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Cores: 8\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Workers: 1\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Workers: 1\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Num TPU Cores Per Worker: 8\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:localhost/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 0, 0)\n"]},{"output_type":"stream","name":"stdout","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)\n"]},{"output_type":"stream","name":"stderr","text":["INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 0, 0)\n","Some layers from the model checkpoint at bert-base-multilingual-cased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']\n","- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","All the layers of TFBertModel were initialized from the model checkpoint at bert-base-multilingual-cased.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.\n"]},{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n"]},{"output_type":"stream","name":"stderr","text":["INFO:absl:TPU has inputs with dynamic shapes: [<tf.Tensor 'Const:0' shape=() dtype=int32>, <tf.Tensor 'IteratorGetNext:0' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:1' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:2' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:3' shape=(None, 10) dtype=uint8>]\n","INFO:absl:TPU has inputs with dynamic shapes: [<tf.Tensor 'Const:0' shape=() dtype=int32>, <tf.Tensor 'IteratorGetNext:0' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:1' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:2' shape=(None, 20) dtype=int64>, <tf.Tensor 'IteratorGetNext:3' shape=(None, 10) dtype=uint8>]\n"]},{"output_type":"stream","name":"stdout","text":["88/88 [==============================] - 108s 73ms/step - loss: 2.1880 - accuracy: 0.2159\n","Epoch 2/10\n","88/88 [==============================] - 6s 73ms/step - loss: 1.1628 - accuracy: 0.8523\n","Epoch 3/10\n","88/88 [==============================] - 8s 91ms/step - loss: 0.3249 - accuracy: 1.0000\n","Epoch 4/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.1248 - accuracy: 1.0000\n","Epoch 5/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0685 - accuracy: 1.0000\n","Epoch 6/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0457 - accuracy: 1.0000\n","Epoch 7/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0328 - accuracy: 1.0000\n","Epoch 8/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0245 - accuracy: 1.0000\n","Epoch 9/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0191 - accuracy: 1.0000\n","Epoch 10/10\n","88/88 [==============================] - 6s 73ms/step - loss: 0.0155 - accuracy: 1.0000\n"]}]},{"cell_type":"code","metadata":{"id":"iMvv4VImhyEq"},"source":["sentiment_model.save_weights(\"math_sol_bert.h5\")\n","sentiment_model_2.save_weights(\"math_sol_bert_2.h5\")"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"hB9sUyLFh0bB"},"source":["def predict_convert_data(data_df):\n","    global tokenizer\n","    tokens, masks, segments = [], [], []\n","    \n","    for i in tqdm(range(len(data_df))):\n","\n","        token = tokenizer.encode(data_df[DATA_COLUMN][i], max_length=SEQ_LEN, truncation=True, padding='max_length')\n","        num_zeros = token.count(0)\n","        mask = [1]*(SEQ_LEN-num_zeros) + [0]*num_zeros\n","        segment = [0]*SEQ_LEN\n","\n","        tokens.append(token)\n","        segments.append(segment)\n","        masks.append(mask)\n","\n","    tokens = np.array(tokens)\n","    masks = np.array(masks)\n","    segments = np.array(segments)\n","    return [tokens, masks, segments]\n","\n","# 위에 정의한 convert_data 함수를 불러오는 함수를 정의\n","def predict_load_data(pandas_dataframe):\n","    data_df = pandas_dataframe\n","    data_df[DATA_COLUMN] = data_df[DATA_COLUMN].astype(str)\n","    data_x = predict_convert_data(data_df)\n","    return data_x"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"JG_Bc7BCilEA"},"source":["import logging\n","tf.get_logger().setLevel(logging.ERROR)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"wwLfyACUiogj"},"source":["def sentence_convert_data(data):\n","    global tokenizer\n","    tokens, masks, segments = [], [], []\n","    token = tokenizer.encode(data, max_length=SEQ_LEN, truncation=True, padding='max_length')\n","    \n","    num_zeros = token.count(0) \n","    mask = [1]*(SEQ_LEN-num_zeros) + [0]*num_zeros \n","    segment = [0]*SEQ_LEN\n","\n","    tokens.append(token)\n","    segments.append(segment)\n","    masks.append(mask)\n","\n","    tokens = np.array(tokens)\n","    masks = np.array(masks)\n","    segments = np.array(segments)\n","    return [tokens, masks, segments]\n","\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"xNZr3DclI18O"},"source":["def evaluation_predict(sentence):\n","    data_x = sentence_convert_data(sentence)\n","    predict1 = sentiment_model.predict(data_x)[0]\n","    predict2 = sentiment_model_2.predict(data_x)[0]\n","    predict_list1 = predict1.tolist()\n","    predict_list2 = predict2.tolist()\n","    tmp1 = max(predict_list1)\n","    tmp2 = max(predict_list2)\n","    index1 = predict_list1.index(tmp1)\n","    index2 = predict_list2.index(tmp2)\n","    return index1+index2+2"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NDJUlp09I5v1","executionInfo":{"status":"ok","timestamp":1635619308502,"user_tz":-540,"elapsed":1537,"user":{"displayName":"안영석","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh6dXQCfD5CKQ09cMcejPQJywtx8l6zzIZhNVJb-Q=s64","userId":"00715212761931714687"}},"outputId":"0a2faf1e-e1a3-4a72-8f87-12530fd7da0f"},"source":["evaluation_predict(\"칠 더하기 구는\")"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["16"]},"metadata":{},"execution_count":64}]},{"cell_type":"code","metadata":{"id":"8hFUhZITgfxb"},"source":[""],"execution_count":null,"outputs":[]}]}